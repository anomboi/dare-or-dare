// Main HTML and CSS updates with animations and enhancements based on previous context
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dares or Dares - Neon Rave Edition</title>
  <style>
    body {
      background-color: #0f0f0f;
      font-family: 'Orbitron', sans-serif;
      color: white;
      text-align: center;
      padding: 20px;
    }
    h1 {
      color: #f0f;
      text-shadow: 0 0 10px #f0f, 0 0 20px #0ff;
    }
    input, button {
      font-size: 1rem;
      padding: 10px;
      margin: 5px;
      border: none;
      border-radius: 5px;
    }
    button {
      background: #222;
      color: white;
      cursor: pointer;
      box-shadow: 0 0 10px #00f;
      transition: all 0.2s ease-in-out;
    }
    button:disabled {
      background-color: #444;
      color: #888;
      cursor: not-allowed;
      box-shadow: none;
    }
    button:hover:not(:disabled) {
      background-color: #333;
      box-shadow: 0 0 15px #0ff;
    }
    .neon-pulse {
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 10px #0ff; }
      50% { box-shadow: 0 0 25px #0ff; }
      100% { box-shadow: 0 0 10px #0ff; }
    }
    .dare-card {
      animation: flip 0.6s ease-in-out;
    }
    @keyframes flip {
      0% { transform: rotateY(0); opacity: 0; }
      50% { transform: rotateY(90deg); opacity: 0.5; }
      100% { transform: rotateY(0); opacity: 1; }
    }
    .flash-red {
      animation: flashRed 0.3s;
    }
    @keyframes flashRed {
      0% { background-color: red; }
      100% { background-color: transparent; }
    }
    #scoreboard td.updated {
      animation: glowUpdate 0.5s ease-in-out;
    }
    @keyframes glowUpdate {
      from { background-color: #111; }
      to { background-color: #0ff; }
    }
  </style>
</head>
<body>
  <h1>ðŸŽ‰ Dares or Dares: Neon Rave ðŸŽ‰</h1>

  <!-- Player setup + max skips UI -->
  <div id="setup">
    <input type="text" id="playerInput" placeholder="Enter player name" />
    <button onclick="addPlayer()">Add Player</button>
    <input type="number" id="maxSkipsInput" placeholder="Max skips per player" />
    <button onclick="startGame()">Start Game</button>
    <ul id="playerList"></ul>
  </div>

  <!-- Game controls -->
  <div id="game" style="display:none;">
    <h2 id="currentPlayer"></h2>
    <div id="dareText" class="dare-card"></div>
    <button id="nextBtn" onclick="nextDare()">Next</button>
    <button id="acceptBtn" onclick="acceptDare()" disabled>Accept</button>
    <button id="skipBtn" onclick="skipDare()" disabled>Skip (1 shot)</button>

    <!-- Scoreboard and skips chart -->
    <canvas id="skipChart" width="400" height="200"></canvas>
    <table border="1" id="scoreboard">
      <thead>
        <tr><th>Player</th><th>Skips</th><th>History</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let players = [];
    let maxSkips = 3;
    let dareIndex = 0;
    let currentDare = "";
    let currentPlayerIndex = 0;
    let dareQueue = [];

    const allDares = [
      "Do a body shot off someone.",
      "Exchange clothes with someone.",
      "Let someone sit on your lap for 3 rounds.",
      "Grind on someone for 20 seconds.",
      "Let someone put ice down your underwear.",
      "Have a staring contest with someone while touching knees.",
      "Whisper a fantasy into someone's ear.",
      "Let someone spank you 3 times.",
      "Play 7 minutes in heaven with someone.",
      "Let someone draw something on your body with a marker."
    ];

    function addPlayer() {
      const input = document.getElementById("playerInput");
      const name = input.value.trim();
      if (name && !players.find(p => p.name === name)) {
        players.push({ name, skips: 0, history: [] });
        document.getElementById("playerList").innerHTML += `<li>${name}</li>`;
        input.value = "";
      }
    }

    function startGame() {
      maxSkips = parseInt(document.getElementById("maxSkipsInput").value) || 3;
      if (players.length < 2) return alert("At least 2 players needed");
      dareQueue = [...allDares];
      shuffle(dareQueue);
      currentPlayerIndex = 0;
      document.getElementById("setup").style.display = "none";
      document.getElementById("game").style.display = "block";
      updateScoreboard();
      resetButtons();
    }

    function nextDare() {
      if (dareQueue.length === 0) dareQueue = shuffle([...allDares]);
      currentDare = dareQueue.pop();
      let darePlayer = players[currentPlayerIndex];
      let others = players.filter((_, i) => i !== currentPlayerIndex);
      let someone = others[Math.floor(Math.random() * others.length)].name;
      currentDare = currentDare.replace("someone", someone);
      document.getElementById("dareText").innerText = currentDare;
      document.getElementById("dareText").classList.add("dare-card");
      document.getElementById("currentPlayer").innerText = `${darePlayer.name}'s turn`;

      document.getElementById("nextBtn").disabled = true;
      document.getElementById("acceptBtn").disabled = false;
      document.getElementById("skipBtn").disabled = darePlayer.skips >= maxSkips;
    }

    function acceptDare() {
      let player = players[currentPlayerIndex];
      player.history.push(currentDare);
      nextTurn();
    }

    function skipDare() {
      let player = players[currentPlayerIndex];
      if (player.skips < maxSkips) {
        player.skips++;
        player.history.push("SKIPPED: " + currentDare);
        document.body.classList.add("flash-red");
        setTimeout(() => document.body.classList.remove("flash-red"), 200);
      }
      nextTurn();
    }

    function nextTurn() {
      updateScoreboard();
      updateChart();
      currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
      resetButtons();
    }

    function resetButtons() {
      document.getElementById("dareText").innerText = "";
      document.getElementById("nextBtn").disabled = false;
      document.getElementById("acceptBtn").disabled = true;
      document.getElementById("skipBtn").disabled = true;
    }

    function updateScoreboard() {
      const tbody = document.querySelector("#scoreboard tbody");
      tbody.innerHTML = "";
      players.forEach(p => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${p.name}</td><td>${p.skips}</td><td>${p.history.join("<br>")}</td>`;
        tbody.appendChild(row);
      });
    }

    let chart;
    function updateChart() {
      const ctx = document.getElementById("skipChart").getContext("2d");
      const data = {
        labels: players.map(p => p.name),
        datasets: [{
          label: "Skips",
          data: players.map(p => p.skips),
          backgroundColor: "rgba(255, 0, 255, 0.7)",
        }]
      };
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'bar',
        data,
        options: {
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }
  </script>
</body>
</html>
